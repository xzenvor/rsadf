<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rat Kombat</title>
    <script>
        const API_BASE_URL = "http://127.0.0.1:5000";
        let userId = localStorage.getItem("user_id");

        async function getUserData() {
            const response = await fetch(`${API_BASE_URL}/get_user_data/${userId}`);
            if (response.ok) {
                const data = await response.json();
                document.getElementById("cheeseBalance").innerText = `–°—ã—Ä: ${data.cheese}`;
            }
        }

        async function earnCheese() {
            const response = await fetch(`${API_BASE_URL}/earn_cheese`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ user_id: userId })
            });

            if (response.ok) {
                const data = await response.json();
                document.getElementById("cheeseBalance").innerText = `–°—ã—Ä: ${data.cheese}`;
            }
        }

        async function upgrade() {
            const response = await fetch(`${API_BASE_URL}/update_user_data`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ user_id: userId, cheese: 0, upgrade: 2 })
            });

            if (response.ok) {
                alert("‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ –∫—É–ø–ª–µ–Ω–æ!");
                getUserData();
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            if (!userId) {
                userId = prompt("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à ID:");
                localStorage.setItem("user_id", userId);
            }
            getUserData();
        });
    </script>
</head>
<body>
    <h1>üêÄ Rat Kombat</h1>
    <p id="cheeseBalance">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
    <button onclick="earnCheese()">üêÄ –ó–∞—Ä–∞–±–æ—Ç–∞—Ç—å —Å—ã—Ä</button>
    <button onclick="upgrade()">‚ö° –£–ª—É—á—à–µ–Ω–∏–µ</button>
</body>
</html>
